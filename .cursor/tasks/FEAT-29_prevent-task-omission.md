# タスク漏れ防止機能の実装

AIとの長い会話において、コンテキストが失われることで要件の抜け漏れが発生する問題を解決する。タスクファイルへの詳細な記録を徹底することで、チャット切り替えや長期化した会話でもコンテキストを維持できるようにする。

## Completed Tasks

- [x] cursor-tasks.mdc に「AIの振る舞いと責任」セクションを追加
- [x] cursor-tasks.mdc の Implementation Plan セクション説明を拡張版に更新
- [x] 「AIの振る舞いと責任」を見出し2に昇格（重要度を強調）
- [x] 重複する「タスク完了の判定」セクションを削除
- [x] 重複する「コミットのタイミング」セクションを削除

## In Progress Tasks

なし

## Future Tasks

- [ ] 実装後の動作確認（新しいチャットで試す）
- [ ] 必要に応じてルールの微調整

## Implementation Plan

### 目標

- AIがコンテキストを失わずタスクを継続できる仕組みを確立
- AIがイエスマンにならず、建設的な議論ができる文化を醸成
- タスクファイルを「使い捨て可能な詳細ログ」として活用

### 要件・制約事項

- **コンテキスト保持の徹底**: チャットログは揮発するため、すべての重要情報をタスクファイルに記録
- **イエスマン防止**: AIは技術専門家として率直に意見し、代替案や改善案を積極提案
- **詳細な記録**: タスクファイルは容量を気にせず詳細に記録（後で見返して理解できるレベル）
- **強制力**: このルールは絶対に守る（毎回のチャットで適用）
- **配置場所**: cursor-tasks.mdc に記載（タスク管理に特化した内容のため）

### 検討事項・議論ログ

#### AIの役割定義
- **提案A（採用）**: 固定表現「技術的な専門家かつプロダクト思考を持つエンジニア」
  - 理由: タスク固有の専門知識はAIが文脈から判断可能、ロール定義の手間を削減
- **提案B（不採用）**: タスクファイルごとに「AI Role」セクションを追加
  - 理由: 毎回の定義が手間、固定ロールで十分

#### タスクファイルのセクション拡張
- Implementation Plan に以下を追加:
  - **要件・制約事項**: ユーザー要望、制約の明示
  - **検討事項・議論ログ**: 技術選択、AIの提案、議論内容
  - **決定事項**: 確定した判断と変更理由
- ref/ の使い分け: 長大な外部仕様は ref/、要件や議論は Implementation Plan 内

### 決定事項

1. **AIの役割**: 「技術的な専門家かつプロダクト思考を持つエンジニア」として振る舞う（固定表現）
2. **Implementation Plan 拡張**: 要件・制約事項、検討事項・議論ログ、決定事項の3セクションを追加
3. **ルール配置**: cursor-tasks.mdc の「AIによるタスク管理」セクションに追加 → **見出し2に昇格**
4. **強制力**: 最優先事項として、毎回のチャットで必ず適用
5. **セクション整理**: 重複する「タスク完了の判定」「コミットのタイミング」セクションを削除（簡潔化）

### アーキテクチャ

- 既存の cursor-tasks.mdc に新セクションを追加する形で実装
- Implementation Plan の構造を拡張（後方互換性あり）
- 既存のタスクファイルは移行不要（新規作成時から適用）

### データフロー

1. AI がチャット開始時に cursor-tasks.mdc を読み込む
2. 「AIの振る舞いと責任」ルールに従って行動
3. 会話中の要件・議論・決定を即座に Implementation Plan に記録
4. チャット切り替え時も次の AI がタスクファイルからコンテキストを復元

### その他

- このタスクファイル自体が新形式の実践例
- ユーザーとの会話内容（背景説明、質疑応答、合意形成）をすべて記録済み

## Relevant Files

- .cursor/rules/cursor-tasks.mdc - タスク管理ルール ✅
- .cursor/tasks/FEAT-29_prevent-task-omission.md - 本タスクファイル ✅

